@if (session) {
<div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200 my-4">
  <div class="p-4 sm:p-6">
    <div class="flex justify-between items-start mb-3">
      <div>

        <h3 class="text-lg font-semibold text-gray-800 leading-tight mb-1" [routerLink]="session.status === 'active' ? ['/meet', session.session_id] : null" [ngClass]="session.status === 'active' ? 'cursor-pointer hover:underline hover:text-green-500': ''">
          {{ session.title.session_title }}
        </h3>
        <p class="text-sm text-gray-500">{{ session.session_id }}</p>
      </div>
      <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium" [ngClass]="getBadgeClass()">
        {{ session.status | titlecase }}
      </span>
    </div>

    <div class="flex items-center gap-2 text-sm text-gray-600 mb-2">
      <mat-icon class="size-5 text-green-500">schedule</mat-icon>
      <strong class="font-medium text-gray-700">Duration:</strong>
      <span class="font-semibold text-green-600">{{ formatDuration(session.duration) }}</span>
    </div>

    <p class="text-sm text-gray-600">
      <strong class="font-medium text-gray-700">Created:</strong>
      {{ formatDateTime(session.created_at) }}
    </p>

    @if (session.status === 'completed' && session.completed_at) {
    <p class="text-sm text-gray-600">
      <strong class="font-medium text-gray-700">Completed:</strong>
      {{ formatDateTime(session.completed_at) }}
    </p>
    }
    @if (session.status === 'active') {
    <div class="mt-4 flex flex-wrap gap-2">
      <a [routerLink]="['/meet', session.session_id]" mat-raised-button>Continue to Meeting</a>
    </div>
    }

    <div class="mt-4 flex flex-wrap gap-2">
      @if (session.status === 'completed') {
      <button mat-stroked-button color="accent" (click)="followupSession(session.session_id)">
        <mat-icon>calendar_add_on</mat-icon>
        Follow Up
      </button>
      }
      <!--  -->
      @if (session.status === 'active') {
      <button mat-stroked-button color="primary" (click)="pauseSession()">
        <mat-icon>pause</mat-icon>
        Pause
      </button>
      <button
        mat-stroked-button
        color="accent"
        (click)="initiateExtendSession()"
      >
        <mat-icon>more_time</mat-icon>
        Extend
      </button>
      <button
        mat-stroked-button
        color="warn"
        (click)="initiateDeleteSession()"
      >
        <mat-icon>stop_circle</mat-icon>
        Terminate
      </button>
      }
      <!--  -->
      @if (session.status === 'paused') {        
        <button mat-stroked-button color="primary" (click)="resumeSession()">
          <mat-icon>resume</mat-icon>
          Resume
        </button>
      }
    </div>
  </div>
</div>
} @else {
<p class="text-center text-sm">Loading ...</p>
}

<app-modal
  [isOpen]="!!deleteModalData.sessionId"
  actionText="Confirm"
  (onAction)="deleteSession()"
  (onCancel)="cancelDeleteSession()"
>
  <p class="text-gray-300">Deleting ...</p>
  <h3 class="text-lg my-2 font-semibold">{{ deleteModalData.sessionTitle }}</h3>
  <p class="text-gray-600">Are you sure you want to delete this session?</p>
</app-modal>

<app-modal
  [isOpen]="!!extendModalData.sessionId"
  actionText="Extend"
  (onAction)="extendSession()"
  (onCancel)="cancelExtendSession()"
>
  <p class="text-gray-300">Extend ...</p>
  <h3 class="text-lg my-2 font-semibold">{{ extendModalData.sessionTitle }}</h3>
  <p class="text-gray-600 mb-4">Need some more time with SAKSHI ? Extend it Now</p>
  <mat-form-field class="w-full md:w-auto">
    <mat-label>Extend by</mat-label>
    <mat-select name="additional_duration" [(ngModel)]="extendModalData.additional_duration">
      @for (m of minutes; track m) {
      <mat-option [value]="m">{{ m }} Mins</mat-option>
      }
    </mat-select>
  </mat-form-field>
</app-modal>
